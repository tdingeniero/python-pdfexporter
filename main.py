from fpdf import FPDF
#import plotly.express as px
#import plotly
#import os

pdf_w=210
pdf_h=297

#df = px.data.iris()
#pltx = px.scatter(df,x="sepal_width",y="sepal_length",color="species",size="petal_length",hover_data=['petal_width'])
#plotly.io.write_image(pltx,file="pltx.png",format="png",width=700,height=450)
#pltx=(os.getcwd()+'\\'+"pltx.png")

class PDF(FPDF):
    pass

    def lines(self):
        self.set_line_width(0.0)
        self.line(0,pdf_h/2,210,pdf_h/2)

    def put_logo(self):
        self.set_xy(10.0,20.0)
        self.image("RCBC_LOGO.JPG",link="",type="",w=70,h=30)

    def put_title(self):
        self.set_xy(0.0,0.0)
        self.set_font('Arial','B',9)
        self.set_text_color(0,0,0)
        self.cell(w=200.0,h=110.0,align='C',txt="STATEMENT OF ACCOUNT",border=0)

    def put_header(self):
        self.set_xy(10.0,5.0)
        self.set_font('Arial')
        self.cell(w=0.0,h=115.0,align='L',txt="Name of Borrower:",border=0)
        self.set_xy(40.0, 5.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Teody Ingeniero",border=0)

        self.set_xy(130.0, 5.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Note Amount:   P",border=0)
        self.set_xy(165.0, 5.0)
        self.cell(w=0.0,h=115.0,align='L',txt="12,345.00",border=0)

        self.set_xy(10.0,10.0)
        self.set_font('Arial')
        self.cell(w=0.0,h=115.0,align='L',txt="Account No.:",border=0)
        self.set_xy(40.0, 10.0)
        self.cell(w=0.0,h=115.0,align='L',txt="12-01238-123",border=0)

        self.set_xy(130.0, 10.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Date Booked:",border=0)
        self.set_xy(165.0, 10.0)
        self.cell(w=0.0,h=115.0,align='L',txt="April 7, 2021",border=0)

        self.set_xy(10.0,15.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Loan Type:",border=0)
        self.set_xy(40.0, 15.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Auto",border=0)

        self.set_xy(130.0, 15.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Term (Months):",border=0)
        self.set_xy(165.0, 15.0)
        self.cell(w=0.0,h=115.0,align='L',txt="36",border=0)

        self.set_xy(10.0,20.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Interest Rate:",border=0)
        self.set_xy(40.0, 20.0)
        self.cell(w=0.0,h=115.0,align='L',txt="2.3%",border=0)

        self.set_xy(130.0, 20.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Amortization:    P",border=0)
        self.set_xy(165.0, 20.0)
        self.cell(w=0.0,h=115.0,align='L',txt="3,510.00",border=0)

    def put_details(self):
        self.set_xy(10.0,35.0)
        self.set_font('Arial', 'B', 9)
        self.cell(w=0.0,h=115.0,align='L',txt="OBLIGATION NOT YET DUE",border=0)
        self.set_xy(20.0, 40.0)
        self.set_font('Arial')
        self.cell(w=0.0,h=115.0,align='L',txt="Principal",border=0)
        self.set_xy(95.0, 40.0)
        self.set_font('Arial', 'B', 9)
        self.cell(w=0.0, h=115.0, align='L', txt="P", border=0)
        self.set_xy(120.0, 40.0)
        self.set_font('Arial')
        self.cell(w=00.0, h=115.0, align='L', txt="-", border=0)
        self.set_xy(140.0, 40.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)
        self.set_xy(20.0, 45.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Regular Interest",border=0)
        self.set_xy(120.0, 45.0)
        self.cell(w=0.0, h=115.0, align='L', txt="-", border=0)
        self.set_xy(140.0, 45.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)

        self.set_xy(10.0,50.0)
        self.set_font('Arial', 'B', 9)
        self.cell(w=0.0,h=115.0,align='L',txt="OBLIGATION DUE",border=0)
        self.set_xy(20.0, 55.0)
        self.set_font('Arial')
        self.cell(w=0.0,h=115.0,align='L',txt="Principal",border=0)
        self.set_xy(95.0, 55.0)
        self.set_font('Arial', 'B', 9)
        self.cell(w=0.0, h=115.0, align='L', txt="P", border=0)
        self.set_xy(120.0, 55.0)
        self.set_font('Arial')
        self.cell(w=00.0, h=115.0, align='L', txt="-", border=0)
        self.set_xy(140.0, 55.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)
        self.set_xy(20.0, 60.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Regular Interest",border=0)
        self.set_xy(120.0, 60.0)
        self.cell(w=0.0, h=115.0, align='L', txt="-", border=0)
        self.set_xy(140.0, 60.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)
        self.set_xy(20.0, 65.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Past due Interest",border=0)
        self.set_xy(120.0, 65.0)
        self.cell(w=0.0, h=115.0, align='L', txt="-", border=0)
        self.set_xy(140.0, 65.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)
        self.set_xy(20.0, 70.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Penalty Charges",border=0)
        self.set_xy(120.0, 70.0)
        self.cell(w=0.0, h=115.0, align='L', txt="-", border=0)
        self.set_xy(140.0, 70.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)

        self.set_xy(10.0,75.0)
        self.set_font('Arial', 'B', 9)
        self.cell(w=0.0,h=115.0,align='L',txt="TOTAL DUE TO UPDATE",border=0)
        self.set_font('Arial')
        self.set_xy(140.0, 75.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)

        self.set_line_width(0.2)
        self.line(135,135,160,135)

        self.set_xy(10.0,80.0)
        self.set_font('Arial', 'B', 9)
        self.cell(w=0.0,h=115.0,align='L',txt="TOTAL OBLIGATION DUE",border=0)
        self.set_xy(130.0, 80.0)
        self.cell(w=0.0, h=115.0, align='L', txt="P", border=0)
        self.set_xy(120.0, 80.0)
        self.set_font('Arial')
        self.set_xy(140.0, 80.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)

        self.set_xy(10.0,85.0)
        self.set_font('Arial', 'B', 9)
        self.cell(w=0.0,h=115.0,align='L',txt="ADD Other Charges:",border=0)
        self.set_xy(20.0, 90.0)
        self.set_font('Arial')
        self.cell(w=0.0,h=115.0,align='L',txt="Bank Service Charge",border=0)
        self.set_xy(95.0, 90.0)
        self.set_font('Arial', 'B', 9)
        self.cell(w=0.0, h=115.0, align='L', txt="P", border=0)
        self.set_xy(120.0, 90.0)
        self.set_font('Arial')
        self.cell(w=00.0, h=115.0, align='L', txt="-", border=0)
        self.set_xy(140.0, 90.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)
        self.set_xy(20.0, 95.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Cancellation Fee",border=0)
        self.set_xy(120.0, 95.0)
        self.cell(w=0.0, h=115.0, align='L', txt="-", border=0)
        self.set_xy(140.0, 95.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)
        self.set_xy(20.0, 100.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Motor Insurance Premium",border=0)
        self.set_xy(120.0, 100.0)
        self.cell(w=0.0, h=115.0, align='L', txt="-", border=0)
        self.set_xy(140.0, 100.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)
        self.set_xy(20.0, 105.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Notarial Fee",border=0)
        self.set_xy(120.0, 105.0)
        self.cell(w=0.0, h=115.0, align='L', txt="-", border=0)
        self.set_xy(140.0, 105.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)
        self.set_xy(20.0, 110.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Processing Fee",border=0)
        self.set_xy(120.0, 110.0)
        self.cell(w=0.0, h=115.0, align='L', txt="-", border=0)
        self.set_xy(140.0, 110.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)
        self.set_xy(20.0, 115.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Transaction Fee",border=0)
        self.set_xy(120.0, 115.0)
        self.cell(w=0.0, h=115.0, align='L', txt="-", border=0)
        self.set_xy(140.0, 115.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)
        self.set_xy(20.0, 120.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Accrued Interest",border=0)
        self.set_xy(120.0, 120.0)
        self.cell(w=0.0, h=115.0, align='L', txt="-", border=0)
        self.set_xy(140.0, 120.0)
        self.cell(w=0.0, h=115.0, align='L', txt="12,345.00", border=0)

        self.set_line_width(0.2)
        self.line(135,180,160,180)

        self.set_xy(10.0,125.0)
        self.set_font('Arial', 'B', 9)
        self.cell(w=0.0,h=115.0,align='L',txt="TOTAL AMOUNT DUE AS OF APRIL 06, 2021",border=0)
        self.set_xy(130.0, 125.0)
        self.cell(w=0.0, h=115.0, align='L', txt="P", border=0)
        self.set_xy(140.0, 125.0)
        self.set_font('Arial')
        self.cell(w=00.0, h=115.0, align='L', txt="12,345.00", border=0)

        self.set_line_width(0.2)
        self.line(135,185,160,185)
        self.line(135,186, 160, 186)

        self.set_xy(20.0, 135.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Date of Last Payment",border=0)
        self.set_xy(75.0, 135.0)
        self.cell(w=0.0,h=115.0,align='L',txt="1/0/1900",border=0)
        self.set_xy(20.0, 140.0)
        self.cell(w=0.0,h=115.0,align='L',txt="Daily Interest",border=0)
        self.set_xy(75.0, 140.0)
        self.cell(w=0.0,h=115.0,align='L',txt="0.00",border=0)

    def put_footer(self):
        self.set_xy(0.0,155.0)
        self.set_font('Arial','B',9)
        self.set_text_color(0,0,0)
        self.cell(w=200.0,h=110.0,align='C',txt="***Checked and verified by CMD Operations Analyst 1***",border=0)

        self.set_xy(10.0,170.0)
        self.set_font('Arial')
        self.cell(w=0.0,h=100.0,align='L',txt="NOTE: TOTAL OBLIGATION IS STILL SUBJECT FOR FINAL AUDIT.",border=0)
        self.set_xy(25.0, 175.0)
        self.set_font('Arial','B',9)
        self.cell(w=0.0, h=100.0, align='L', txt="4/6/2021", border=0)



pdf = PDF(orientation="P",unit="mm",format="A4")
pdf.add_page()
pdf.put_logo()
pdf.put_title()
pdf.put_header()
pdf.put_details()
pdf.put_footer()
pdf.output('test2.pdf','F')

